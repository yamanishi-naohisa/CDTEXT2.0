# iTunes→EAC CD情報自動転送システム 詳細仕様書 (GUI版 v2.0)

## 目次

1. [システム概要](#1-システム概要)
2. [技術仕様](#2-技術仕様)
3. [GUI仕様](#3-gui仕様)
4. [邦題検索機能仕様](#4-邦題検索機能仕様)
5. [Web検索API統合](#5-web検索api統合)
6. [信頼度評価システム](#6-信頼度評価システム)
7. [キャッシュ管理](#7-キャッシュ管理)
8. [ユーザー操作手順](#8-ユーザー操作手順)
9. [設定ファイル仕様](#9-設定ファイル仕様)
10. [システムアーキテクチャ](#10-システムアーキテクチャ)
11. [トラブルシューティング](#11-トラブルシューティング)
12. [開発者向け情報](#12-開発者向け情報)

---

## 1. システム概要

### 1.1 目的

iTunesで取得したCD情報（トラック名、アーティスト、アルバム名等）をEAC（Exact Audio Copy）で利用可能な形式に変換し、リッピング作業を効率化する。GUI提供により直感的な操作を実現。

**v2.0新機能**: クラシックCDなど英語タイトルのみの場合、Web検索により日本語タイトルを自動取得・適用可能。

### 1.2 システム構成

- **入力**: iTunes COM APIから取得したCD情報
- **処理**: 
  - Python スクリプトによるデータ変換・ファイル生成
  - Web検索による邦題取得（Wikipedia、MusicBrainz等）
  - 手動編集・確認機能
- **出力**: CDPLAYER.INI ファイル
- **UI**: tkinter によるグラフィカルユーザーインターフェース
- **連携**: GUI上でiTunes/EACの起動・終了・状態確認を一元管理

### 1.3 v2.0 主要追加機能

1. **Web検索による邦題取得**
   - Wikipedia日本語版API
   - MusicBrainz API
   - 自動検索・マッチング

2. **タイトル編集機能**
   - トラックごとの手動編集
   - 一括置換
   - 検索結果から選択適用

3. **信頼度表示**
   - 自動取得した邦題の信頼度スコア
   - 複数候補の表示・選択

4. **ハイブリッド検出方式**
   - プロセス検出とCOMオブジェクト取得の両方でiTunes起動を判定
   - Microsoft Store版iTunesでもプロセス検出で起動状態を確認可能

---

## 2. 技術仕様

### 2.1 開発環境

**言語**: Python 3.8以上

**必要ライブラリ**:
- `tkinter` - GUI（Python標準ライブラリ）
- `pywin32` (win32com.client) - iTunes COM API制御
- `subprocess` - プロセス起動・終了制御
- `pathlib` - ファイルパス操作
- `threading` - 非同期処理（GUIフリーズ防止）
- `configparser` - INIファイル操作
- `json` - ログ・履歴保存
- `requests` - Web API呼び出し
- `beautifulsoup4` - HTML解析
- `musicbrainzngs` - MusicBrainz API

### 2.2 対応環境

- **OS**: Windows 10/11
- **iTunes**: Windows版（Microsoft Store版はCOM接続が不安定な場合あり）
- **EAC**: バージョン1.0以降
- **画面解像度**: 最小 1024x768 推奨
- **インターネット接続**: 邦題検索機能使用時必須

### 2.3 ファイル構成（実際の構成）

```
CDTEXT2.0/
├── itunes_to_eac_gui.py      # GUIメインスクリプト
├── config.ini                 # 設定ファイル
├── requirements.txt           # 依存ライブラリ
├── README.md                  # 使用説明書
├── controllers/               # コントローラーモジュール
│   ├── __init__.py
│   ├── itunes_controller.py   # iTunes制御（ハイブリッド検出方式実装）
│   └── eac_controller.py      # EAC制御
├── models/                    # データモデル
│   ├── __init__.py
│   ├── cd_info.py            # CDInfoデータクラス
│   ├── track.py              # Trackデータクラス
│   └── search_result.py      # SearchResultデータクラス
├── generators/                # 生成モジュール
│   ├── __init__.py
│   └── cdplayer_generator.py  # CDPLAYER.INI生成
├── search/                    # Web検索モジュール
│   ├── __init__.py
│   ├── web_search_manager.py # Web検索統合管理
│   ├── wikipedia_searcher.py # Wikipedia検索
│   ├── musicbrainz_searcher.py # MusicBrainz検索
│   ├── matcher.py            # トラックマッチング
│   ├── confidence_scorer.py  # 信頼度評価
│   └── cache_manager.py      # キャッシュ管理
├── utils/                     # ユーティリティ
│   ├── __init__.py
│   ├── config_manager.py     # 設定管理
│   ├── logger.py             # ログシステム
│   └── history_manager.py    # 履歴管理
├── logs/                      # ログ出力ディレクトリ
├── history/                   # CD処理履歴ディレクトリ
└── cache/                     # 検索キャッシュ
    └── search_results/
```

---

## 3. GUI仕様

### 3.1 ウィンドウ構成

#### 3.1.1 メインウィンドウ（v2.0拡張版）

- **ウィンドウサイズ**: 900x700 (リサイズ可能)
- **タイトル**: "iTunes → EAC CD情報転送ツール v2.0"
- **レイアウト**: 4ペイン構成

```
┌──────────────────────────────────────────────────────────┐
│ iTunes → EAC CD情報転送ツール v2.0          [_][□][X]   │
├──────────────────────────────────────────────────────────┤
│ [メニューバー]                                            │
├──────────────────────────────────────────────────────────┤
│                                                           │
│  ┌─ アプリケーション制御 ─────────────────────┐        │
│  │ iTunes: [●起動中] [起動] [終了]              │        │
│  │ EAC:    [○未起動] [起動] [終了]              │        │
│  └───────────────────────────────────────────┘        │
│                                                           │
│  ┌─ CD情報 ─────────────────────────────────┐        │
│  │ 状態: [✓ 情報取得完了]                       │        │
│  │                                              │        │
│  │ アーティスト: [Queen]                        │        │
│  │ アルバム:     [A Night at the Opera]        │        │
│  │ トラック数:   [12]  言語: [✓ 日本語]        │        │
│  │                                              │        │
│  │ ┌─ トラックリスト ───────────────┐         │        │
│  │ │ #  原題                   邦題       信頼度│         │
│  │ ├──────────────────────────────┤         │        │
│  │ │ 01 Bohemian Rhapsody    ボヘミアン... ★★★│         │
│  │ │ 02 Death On Two Legs    [未取得]         │         │
│  │ │ 03 Lazing On A Sunday... 怠惰な日曜... ★★ │         │
│  │ └──────────────────────────────┘         │        │
│  └───────────────────────────────────────────┘        │
│                                                           │
│  ┌─ 操作 ──────────────────────────────────┐        │
│  │ [1. iTunesでCD情報取得]                     │        │
│  │ [1-B. 日本語タイトル検索] 🌐               │        │
│  │ [2. CDPLAYER.INI生成]                       │        │
│  │ [3. EACで読み込み]                          │        │
│  │                                              │        │
│  │ [■■■■■■□□□□] 処理中 (60%)            │        │
│  └───────────────────────────────────────────┘        │
│                                                           │
│  ┌─ ログ/ステータス ──────────────────────┐        │
│  │ [INFO] iTunes起動完了                        │        │
│  │ [SUCCESS] CD情報取得完了                     │        │
│  │ [INFO] Wikipedia検索中: "Queen A Night..."  │        │
│  │ [SUCCESS] 邦題3件取得完了                    │        │
│  └───────────────────────────────────────────┘        │
│                                                           │
└──────────────────────────────────────────────────────────┘
```

#### 3.1.2 メニューバー（v2.0拡張）

**ファイル (F)**
- 設定 (S) - 設定ダイアログを開く
- 履歴表示 (H) - CD処理履歴ウィンドウを開く
- 検索キャッシュをクリア - 保存された検索結果を削除
- 終了 (X) - アプリケーション終了

**編集 (E)**
- トラック情報を編集 (E) - 選択トラックの編集ダイアログ
- すべて原題に戻す (R) - 邦題をクリア
- 一括置換 (B) - 複数トラックの一括編集

**ツール (T)**
- CDPLAYER.INIを開く - エクスプローラーで表示
- ログフォルダを開く - ログディレクトリを表示
- 手動更新 (R) - CD情報を手動で再取得
- 検索エンジン設定 - Wikipedia/MusicBrainz優先度設定

**ヘルプ (H)**
- 使い方 (U) - 使用方法ダイアログ
- 邦題検索について - Web検索機能の説明
- バージョン情報 (A) - バージョン・ライセンス情報

---

## 4. 邦題検索機能仕様

### 4.1 概要

クラシックCD等で英語タイトルのみ取得された場合に、Web検索により日本語タイトルを自動取得する機能。

### 4.2 検索フロー

```
[CD情報取得完了]
    ↓
[言語判定] → 英語のみ? → YES
    ↓                      ↓
   NO                  [邦題検索ボタン有効化]
    ↓                      ↓
[スキップ可能]        [ユーザーがクリック]
                           ↓
                   [検索実行]
                           ↓
                ┌──────────────────┐
                │                  │
          [Wikipedia]      [MusicBrainz]
                │                  │
                └─────┬────────────┘
                      ↓
              [検索結果統合]
                      ↓
              [信頼度スコアリング]
                      ↓
              [候補リスト表示]
                      ↓
          [ユーザー確認・選択]
                      ↓
              [CD情報に反映]
                      ↓
          [CDPLAYER.INI生成]
```

### 4.3 検索対象の判定

#### 4.3.1 言語自動判定

`models/cd_info.py`の`detect_language()`メソッドで実装：

```python
def detect_language(self) -> str:
    """言語自動判定"""
    japanese_pattern = r'[\u3040-\u309F\u30A0-\u30FF\u4E00-\u9FFF]'
    
    ja_count = 0
    en_count = 0
    
    for track in self.tracks:
        if re.search(japanese_pattern, track.title):
            ja_count += 1
        else:
            en_count += 1
    
    if ja_count == 0:
        return 'en'
    elif en_count == 0:
        return 'ja'
    else:
        return 'mixed'
```

**判定基準**:
- アルバム名に日本語が含まれる → スキップ可能
- 全トラックに日本語なし → 邦題検索推奨
- 一部トラックのみ日本語 → 部分検索推奨

#### 4.3.2 検索要否の表示

| 状態 | 表示 | アクション |
|------|------|-----------|
| 全て英語 | 🌐[日本語化推奨] | 自動で検索ボタン強調 |
| 一部日本語 | 🌐[一部日本語化] | オプション表示 |
| 全て日本語 | ✓ 日本語 | 検索ボタン非表示 |

---

## 5. Web検索API統合

### 5.1 Wikipedia日本語版API

#### 5.1.1 接続仕様

**エンドポイント**: `https://ja.wikipedia.org/w/api.php`

**実装**: `search/wikipedia_searcher.py`

#### 5.1.2 検索実装

- `action=query` - ページ検索
- `action=parse` - ページ内容取得
- BeautifulSoupによるHTML解析でトラックリスト抽出

### 5.2 MusicBrainz API

#### 5.2.1 接続仕様

**ライブラリ**: `musicbrainzngs`

**エンドポイント**: https://musicbrainz.org/ws/2/

**実装**: `search/musicbrainz_searcher.py`

#### 5.2.2 検索実装

- リリース検索
- 詳細情報取得（トラックリスト含む）
- 日本語エイリアス（別名）の検索

### 5.3 検索結果統合

#### 5.3.1 マッチングアルゴリズム

**実装**: `search/matcher.py`

- 文字列類似度計算（SequenceMatcher）
- トラック番号の一致確認
- 複数候補の優先順位付け

#### 5.3.2 候補の優先順位付け

**スコアリング基準**:

| 要素 | 配点 | 詳細 |
|------|------|------|
| 文字列類似度 | 40点 | 0.7以上で加点 |
| トラック番号一致 | 20点 | 順序が正しい |
| ソース信頼性 | 20点 | Wikipedia > MusicBrainz |
| トラックリスト完全性 | 10点 | 全トラック邦題あり |
| アルバム名一致度 | 10点 | アルバム名の類似度 |

---

## 6. 信頼度評価システム

### 6.1 信頼度レベル定義

**実装**: `models/track.py`の`get_confidence_stars()`メソッド

| レベル | スコア | 表示 | 意味 |
|--------|--------|------|------|
| 高 | 80-100 | ★★★ | Wikipedia公式ページ、完全一致 |
| 中 | 60-79 | ★★ | MusicBrainz、部分一致 |
| 低 | 40-59 | ★ | 一般検索、不完全一致 |
| 不明 | 0-39 | [?] | 信頼性低、要確認 |

### 6.2 自動適用ルール

**設定可能な動作**:

1. **自動適用モード**:
   - スコア80以上 → 自動適用
   - スコア60-79 → ユーザー確認
   - スコア59以下 → 適用しない

2. **手動確認モード**（推奨・デフォルト）:
   - 全ての候補をユーザーに提示
   - ユーザーが選択・承認

3. **保守的モード**:
   - スコア90以上のみ自動適用
   - その他は全て手動確認

---

## 7. キャッシュ管理

### 7.1 キャッシュ構造

**実装**: `search/cache_manager.py`

```
cache/
├── search_results/
│   ├── <artist>_<album>_<hash>.json
│   └── ...
└── cache_index.json
```

### 7.2 キャッシュ有効期限

- デフォルト: 30日
- `config.ini`で設定可能
- 期限切れは自動削除

### 7.3 キャッシュ戦略

**キャッシュするもの**:
- ✓ Wikipedia検索結果
- ✓ MusicBrainz検索結果
- ✓ マッチング結果
- ✗ ユーザー編集内容（履歴として別管理）

**キャッシュクリア条件**:
- 手動クリア（メニューから）
- 30日間未使用
- キャッシュサイズが100MBを超えた場合

---

## 8. ユーザー操作手順

### 8.1 初回セットアップ

#### ステップ1: 環境準備

1. **Python 3.8以上をインストール**
   - 公式サイト: https://www.python.org/downloads/
   - インストール時に「Add Python to PATH」をチェック

2. **必要ライブラリのインストール**:
   ```bash
   pip install -r requirements.txt
   ```

3. **インターネット接続確認**
   - 邦題検索機能を使用する場合は必須
   - オフラインでも基本機能（iTunes→EAC転送）は使用可能

#### ステップ2: アプリケーション配置

1. ダウンロードしたファイルを任意のフォルダに展開
2. フォルダ構成を確認

#### ステップ3: 初回起動・設定

1. `itunes_to_eac_gui.py`をダブルクリック
   または、コマンドプロンプトで:
   ```bash
   python itunes_to_eac_gui.py
   ```

2. `config.ini`でパスが正しいか確認:
   - iTunes: `C:\Program Files\iTunes\iTunes.exe`
   - EAC: `C:\Program Files (x86)\Exact Audio Copy\EAC.exe`
   - 異なる場合は手動で編集

### 8.2 通常使用時の手順

#### パターンA: 邦題検索を使用する場合（推奨）

**1. アプリケーション起動**

**2. CDを挿入**

**3. ステップ1: CD情報取得**
- [1. iTunesでCD情報取得]ボタンをクリック
- 自動処理:
  - iTunes自動起動（未起動の場合）
  - CD認識待機
  - メタデータ取得
- CD情報パネルに情報が表示される
- **言語インジケータを確認**:
  - 🌐[日本語化推奨] - 英語のみ
  - 🌐[一部日本語化] - 混在
  - ✓ 日本語 - 日本語タイトルあり

**4. ステップ1-B: 日本語タイトル検索（新機能）**
- [1-B. 日本語タイトル検索] 🌐ボタンをクリック
- 検索が自動実行される
- プログレスバーで進行状況を確認
- 検索結果が自動適用される（手動確認モードの場合、確認ダイアログが表示）

**5. トラック情報の手動編集（オプション）**
- トラックリストで編集したい行をダブルクリック
- または、右クリック→「このトラックを編集」
- 必要に応じて修正

**6. ステップ2: CDPLAYER.INI生成**
- [2. CDPLAYER.INI生成]ボタンをクリック
- **邦題が適用された状態**でINIファイルが生成される

**7. ステップ3: EACで読み込み**
- [3. EACで読み込み]ボタンをクリック
- EACが自動起動
- 情報ダイアログが表示

**8. EACで確認・リッピング**
- EACウィンドウに切り替え
- メニュー「データベース」→「CD情報を編集」
- **日本語タイトルが正しく表示されていることを確認**
- リッピング開始（EACの通常操作）

#### パターンB: 邦題検索なし（従来の方法）

日本語タイトルが既に取得できている場合、またはWeb検索を使用しない場合:

1. アプリケーション起動
2. CDを挿入
3. [1. iTunesでCD情報取得]ボタンをクリック
4. **ステップ1-Bをスキップ**
5. [2. CDPLAYER.INI生成]ボタンをクリック
6. [3. EACで読み込み]ボタンをクリック
7. EACで確認・リッピング

---

## 9. 設定ファイル仕様 (config.ini v2.0)

```ini
[Paths]
# iTunesインストールパス
itunes_path = C:\Program Files\iTunes\iTunes.exe

# EACインストールパス
eac_path = C:\Program Files (x86)\Exact Audio Copy\EAC.exe

# CDPLAYER.INI出力先（空欄の場合は%USERPROFILE%\CDPLAYER.INI）
cdplayer_output = 

[Options]
# iTunes起動待機時間（秒）
itunes_startup_wait = 10

# iTunes CD認識待機時間（秒）
cd_recognition_wait = 5

# ログ出力レベル
log_level = INFO

[Encoding]
# CDPLAYER.INIのエンコーディング
cdplayer_encoding = shift_jis

[WebSearch]
# Wikipedia日本語版を使用
use_wikipedia_ja = true

# MusicBrainzを使用
use_musicbrainz = true

# 一般Web検索を使用（精度低、非推奨）
use_general_search = false

# 検索タイムアウト（秒）
search_timeout = 30

# 最大候補数
max_candidates = 5

[SearchBehavior]
# 自動適用モード: auto（自動適用）/ manual（手動確認）/ conservative（保守的）
auto_apply_mode = manual

# 自動適用の信頼度閾値（80以上推奨）
auto_apply_threshold = 80

# 低信頼度時に警告表示
warn_low_confidence = true

# 信頼度閾値（この値未満で警告）
low_confidence_threshold = 60

[Cache]
# 検索結果キャッシュを有効化
enable_cache = true

# キャッシュ有効期限（日）
cache_expire_days = 30

# キャッシュディレクトリ
cache_dir = cache
```

---

## 10. システムアーキテクチャ

### 10.1 全体構成図

```
┌─────────────────────────────────────────────────────────┐
│                    GUI Layer (tkinter)                   │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐ │
│  │ Main Window  │  │  Dialogs     │  │  Widgets     │ │
│  └──────┬───────┘  └──────┬───────┘  └──────┬───────┘ │
└─────────┼──────────────────┼──────────────────┼─────────┘
          │                  │                  │
┌─────────┼──────────────────┼──────────────────┼─────────┐
│         ▼                  ▼                  ▼         │
│              Business Logic Layer                       │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐ │
│  │   iTunes     │  │     EAC      │  │   CDPLAYER   │ │
│  │  Controller  │  │  Controller  │  │   Generator  │ │
│  └──────┬───────┘  └──────┬───────┘  └──────┬───────┘ │
│         │                  │                  │         │
│  ┌──────┴───────────────────────────────────┴───────┐ │
│  │         Web Search Manager (v2.0)                 │ │
│  │  ┌────────────┐  ┌────────────┐  ┌────────────┐ │ │
│  │  │ Wikipedia  │  │MusicBrainz │  │   Cache    │ │ │
│  │  │  Searcher  │  │  Searcher  │  │  Manager   │ │ │
│  │  └────────────┘  └────────────┘  └────────────┘ │ │
│  └────────────────────────────────────────────────────┘ │
└─────────┬──────────────────┬──────────────────┬─────────┘
          │                  │                  │
┌─────────┼──────────────────┼──────────────────┼─────────┐
│         ▼                  ▼                  ▼         │
│                  Data Layer                             │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐ │
│  │  CDInfo      │  │   Config     │  │   History    │ │
│  │  Model       │  │   Manager    │  │   Database   │ │
│  └──────────────┘  └──────────────┘  └──────────────┘ │
└─────────┬──────────────────┬──────────────────┬─────────┘
          │                  │                  │
┌─────────┼──────────────────┼──────────────────┼─────────┐
│         ▼                  ▼                  ▼         │
│               External Systems                          │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐ │
│  │   iTunes     │  │     EAC      │  │  Web APIs    │ │
│  │   COM API    │  │  Process     │  │ (Wikipedia,  │ │
│  │              │  │              │  │ MusicBrainz) │ │
│  └──────────────┘  └──────────────┘  └──────────────┘ │
└─────────────────────────────────────────────────────────┘
```

### 10.2 主要クラス設計

#### 10.2.1 iTunesController（ハイブリッド検出方式）

**実装**: `controllers/itunes_controller.py`

**主要メソッド**:
- `_check_process_running()` - プロセス名でiTunesの起動を検出
- `_get_com_object()` - COMオブジェクトを取得（リトライ付き、複数ProgID試行）
- `is_running()` - ハイブリッド方式で起動状態を判定
- `start()` - iTunesを起動（プロセス検出とCOM取得の両方で判定）
- `get_cd_info()` - CD情報を取得

**ハイブリッド検出方式の特徴**:
- プロセス検出で「起動中」を判定（COMが失敗しても）
- COM取得は別途試行し、失敗してもプロセスがあれば続行可能
- Microsoft Store版iTunesでもプロセス検出で起動状態を確認可能

#### 10.2.2 WebSearchManager

**実装**: `search/web_search_manager.py`

**主要メソッド**:
- `search_titles()` - CD情報から邦題を検索
- `apply_search_results()` - 検索結果をCD情報に適用

#### 10.2.3 CDInfo

**実装**: `models/cd_info.py`

**主要メソッド**:
- `detect_language()` - 言語自動判定
- `get_japanese_title_ratio()` - 日本語タイトル取得率

#### 10.2.4 Track

**実装**: `models/track.py`

**主要メソッド**:
- `set_japanese_title()` - 日本語タイトルを設定
- `clear_japanese_title()` - 日本語タイトルをクリア
- `get_confidence_stars()` - 信頼度を星で表示

---

## 11. トラブルシューティング

### 11.1 iTunes起動検出の問題

#### 問題: iTunesが起動しているのに「起動していない」と表示される

**原因**:
- Microsoft Store版のiTunesを使用している場合、COMオブジェクト接続が失敗する可能性
- COMオブジェクトの初期化タイミングの問題

**解決方法**:
- v2.0ではハイブリッド検出方式を実装済み
- プロセス検出で起動状態を確認（COMが失敗しても「起動中」と判定）
- 詳細ログを確認（`log_level = DEBUG`に設定）

### 11.2 邦題検索関連のトラブル

#### 問題1: 検索ボタンが無効のまま

**原因**:
- ステップ1（CD情報取得）が未完了
- 既に全トラックが日本語タイトル

**解決方法**:
1. ステップ1を実行してCD情報を取得
2. 言語インジケータを確認

#### 問題2: 「インターネット接続がありません」エラー

**確認事項**:
- インターネット接続の確認
- ファイアウォール設定

**解決方法**:
1. ブラウザで https://ja.wikipedia.org にアクセス可能か確認
2. ファイアウォールでPythonの通信を許可

#### 問題3: 検索結果が0件

**原因**:
- アーティスト名・アルバム名が特殊
- Wikipediaに該当ページがない

**解決方法**:
1. トラックを個別選択 → 右クリック → 「Web検索」
2. 検索クエリを手動調整
3. 手動編集で直接入力

### 11.3 デバッグモード

**詳細ログ出力**:

1. `config.ini`を編集:
   ```ini
   [Options]
   log_level = DEBUG
   ```

2. アプリケーション再起動

3. `logs/`フォルダ内に詳細ログが出力される

---

## 12. 開発者向け情報

### 12.1 コード規約

- PEP 8準拠
- 型ヒント使用
- docstring記述

### 12.2 テスト

**テストファイル**:
- `test_itunes_connection.py` - iTunes接続テスト

### 12.3 拡張機能実装ガイド

#### カスタム検索エンジンの追加

1. `search/`ディレクトリに新しいSearcherクラスを作成
2. `WebSearchManager`に統合
3. `config.ini`に設定項目を追加

#### エクスポート形式の追加

1. `generators/`ディレクトリに新しいExporterクラスを作成
2. GUIにエクスポート機能を追加

### 12.4 制限事項

| 項目 | 制限内容 | 理由 |
|------|---------|------|
| iTunes依存 | iTunes for Windows必須 | COM API使用 |
| CD必須 | 物理CDが必要 | iTunes API仕様 |
| シングルセッション | 同時に1CDのみ処理 | COM APIの制約 |
| EAC API非対応 | 直接的なメタデータ送信不可 | EAC未公開API |
| Windows専用 | macOS/Linux非対応 | iTunes COM API |

### 12.5 既知の問題

**Issue #1**: Microsoft Store版iTunesでCOM API動作不安定
- **影響**: 一部環境でiTunes起動・制御に失敗
- **回避策**: デスクトップ版iTunesを使用
- **v2.0対応**: ハイブリッド検出方式でプロセス検出により起動状態を確認可能

**Issue #2**: 長いトラック名で文字化け
- **影響**: 255文字を超えるタイトルが切れる
- **回避策**: 手動で短縮

---

## 13. ライセンス・クレジット

### 13.1 本ソフトウェア

- **ライセンス**: MIT License
- **著作権**: © 2024 開発者

### 13.2 使用ライブラリ

| ライブラリ | ライセンス | 用途 |
|-----------|----------|------|
| Python | PSF License | 実行環境 |
| pywin32 | PSF License | iTunes COM API |
| requests | Apache 2.0 | HTTP通信 |
| BeautifulSoup4 | MIT | HTML解析 |
| musicbrainzngs | BSD | MusicBrainz API |
| tkinter | PSF License | GUI |

### 13.3 データソース

- **Wikipedia**: CC BY-SA 3.0 / GFDL
- **MusicBrainz**: CC0 (Public Domain) / Database Contents License

### 13.4 商標

- iTunes: Apple Inc.の商標
- Exact Audio Copy (EAC): Andre Wiethoffの商標
- Windows: Microsoft Corporationの商標

---

## 14. まとめ

### 14.1 主要な新機能（v2.0）

1. ✅ **Web検索による邦題取得**
   - Wikipedia日本語版
   - MusicBrainz
   - 自動マッチング

2. ✅ **信頼度評価システム**
   - スコアリングアルゴリズム
   - 3段階表示（★★★/★★/★）

3. ✅ **トラック編集機能**
   - 個別編集
   - 一括置換
   - Web再検索

4. ✅ **キャッシュシステム**
   - 検索結果保存
   - 有効期限管理

5. ✅ **ハイブリッド検出方式**
   - プロセス検出とCOM取得の両方でiTunes起動を判定
   - Microsoft Store版iTunesでも動作改善

### 14.2 次のステップ

**ユーザー向け**:
1. 初回セットアップを実行
2. サンプルCDで動作確認
3. 本番環境で使用開始

**開発者向け**:
1. 開発環境セットアップ
2. アーキテクチャ理解
3. 拡張機能の実装

---

**以上で、iTunes→EAC CD情報自動転送システム v2.0 詳細仕様書が完成しました！**

